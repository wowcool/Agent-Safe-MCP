# Agent Safe - 9-Tool Message Security Suite for AI Agents (7 Paid + 2 Free)
> MCP Server: https://agentsafe.locationledger.com/mcp
> Protocol: Streamable HTTP (MCP)
> Payment: $0.02/paid tool call via skyfire-api-key header (Skyfire Buyer API Key). assess_message is FREE.
> No signup required

## Tools

### assess_message (FREE — No Authentication Required)
Free triage tool. Send whatever context you have and get a prioritized list of which security tools to run. No AI call, instant response, no cost. Always call this first.
Input: All optional — from (string), subject (string), body (string), links (string[]), urls (string[]), attachments (object[]), sender (string), senderDisplayName (string), platform (string), messages (object[]), draftTo (string), draftBody (string), media (object[])
Returns: recommendedTools[], skippedTools[], totalEstimatedCost, summary

### check_email_safety
Analyze an email for phishing, social engineering, prompt injection, CEO fraud, and data exfiltration.
Input: from (string, required), subject (string, required), body (string, required), links (string[]), attachments (object[]), knownSender (boolean), previousCorrespondence (boolean)
Returns: verdict, riskScore, confidence, threats[], recommendation, explanation, safeActions[], unsafeActions[]

### check_url_safety
Analyze URLs for phishing, malware, redirects, spoofing, and tracking.
Input: urls (string[], required, max 20)
Returns: overallVerdict, overallRiskScore, urlResults[]

### check_response_safety
Check a draft email reply BEFORE sending for data leakage, social engineering compliance, and unauthorized disclosure.
Input: draftTo (string, required), draftSubject (string, required), draftBody (string, required), originalFrom (string), originalSubject (string), originalBody (string)
Returns: verdict, riskScore, confidence, threats[], recommendation

### analyze_email_thread
Analyze a full email conversation thread for escalating social engineering, scope creep, and manipulation patterns.
Input: messages (object[], required, min 2, max 50) - each with from, subject, body, date?
Returns: verdict, riskScore, confidence, manipulationPatterns[], threadProgression

### check_attachment_safety
Assess email attachments for malware risk based on filename, MIME type, and size BEFORE opening/downloading.
Input: attachments (object[], required, max 20) - each with name, size, mimeType, from?
Returns: overallVerdict, overallRiskScore, attachmentResults[]

### check_sender_reputation
Verify sender identity and detect BEC, spoofing, and impersonation. Includes live DNS DMARC and RDAP domain age checks.
Input: email (string, required), displayName (string, required), replyTo (string), emailSubject (string), emailSnippet (string)
Returns: senderVerdict, trustScore, confidence, identityIssues[], domainIntel

### check_message_safety
Analyze non-email messages (SMS, WhatsApp, Instagram DMs, Discord, Slack, Telegram, LinkedIn, Facebook Messenger, iMessage, Signal) for platform-specific threats.
Input: platform (string, required), sender (string, required), messages (object[], required, min 1, max 50) - each with body, direction (inbound/outbound), timestamp?; media (object[]), senderVerified (boolean), contactKnown (boolean)
Returns: verdict, riskScore, confidence, platform, threats[] with messageIndices, recommendation, explanation, safeActions[], unsafeActions[], platformTips

## Quick Start
1. Call assess_message (free, no auth needed) to triage your message
2. Get a Skyfire Buyer API Key at https://skyfire.xyz
3. Add MCP config: { "mcpServers": { "agentsafe": { "command": "npx", "args": ["-y", "mcp-remote", "https://agentsafe.locationledger.com/mcp", "--header", "skyfire-api-key: YOUR_SKYFIRE_BUYER_API_KEY"] } } }
4. Call the recommended tools via MCP tools/call

## Links
- Documentation: https://agentsafe.locationledger.com/docs
- Discovery: https://agentsafe.locationledger.com/mcp/discover
- Terms: https://agentsafe.locationledger.com/terms
